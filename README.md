
# SDPlugin - CLIP Studio Paint用 画像生成プラグイン

クリスタのフィルターとして動作する画像生成プラグインです。

まだ開発＆テスト中ですが一応は動くのでお暇な方は試してみてください。


## 使用方法

以下のパスにフォルダごと放り込んでください。
> ドキュメント/CELSYS/CLIPStudioModule/PlugIn/PAINT

[stable-diffusion.cppのリリースページ](https://github.com/leejet/stable-diffusion.cpp/releases) から自分の環境に合ったファイルをダウンロードしてきて、中に入ってる「stable-diffusion.dll」ファイルをプラグインと同じフォルダに入れてください。

以下３つのファイルが同じフォルダに入ってる状態になっていればOKです。
- SDPlugin.cpm
- SDPlugin.ini
- stable-diffusion.dll

「SDPlugin.ini」ファイル内のモデルのパスとかを調整してください。

```
[COMMON]
	model_path = （モデルのパス）.safetensors
```
（最低限、model_pathさえ設定されてれば動くはず……）

あとはクリスタを起動すれば、メニューのフィルターの所に「Stable Diffusion(X)」の項目が増えてると思います。


## 動作環境

CLIP Studio PAINT EX 1.10で動作するのを確認できました。
それ以降のバージョンなら動くと思います。


## メモ

- プロンプト欄の挙動がおかしい時があります（入力内容が表示されなかったり反映されなかったりする）
	- 調査中、どうもクリスタのバージョンが古いとなりやすいっぽい？
- 透明なレイヤーには生成しません（生成するけど出力しません）ので適当に塗りつぶしてください
	- レイヤーのアルファチャンネル（不透明度）は維持したま生成します
- 選択領域があるとその範囲にだけ生成します（上手くやるとインペイントっぽい挙動に）
- プラグインを入れたフォルダに「debuglog.txt」という名前でデバッグログを吐いてます
	- 生成経過も出してるからちょっと多いかも？ そのうちオプションで切れるようにします
- 選択範囲のサイズで生成します。デカいと死にます。
- 動作モード
	- TXT2IMG: プロンプトだけから生成します
	- IMG2IMG: 画面上の絵でi2iします
	- CONTROL: 画面上の絵をCntrolNetに渡して生成します
		- "controlnet_path" が適切に設定されている必要があります
- 設定ファイルの内容は "COMMON" セクションが共通で使われ、各モード毎の設定が優先されます


## ライセンス

フリーウェアです。

ソースコードもクレジット無しで自由に弄ってもらって大丈夫です。（The Unlicense）


## 保証とサポート

出来ません。もし要望とかあれば遠慮なくissue投げてください。

（むしろプルリク投げてくれてもええんやで……）
